<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width,initial-scale=1.0" />
        <link rel="icon" href="./favicon.ico" />
        <title>ramp-core</title>

        <link rel="stylesheet" href="./../dist/RAMP.css" />

        <!-- these two fixtures will load before either RAMP is loaded -->
        <script src="./../dist/sample-fixtures/mouruge-fixture.js"></script>
        <script src="./../dist/sample-fixtures/diligord-fixture.js"></script>

        <!-- the host page must load Vue since RAMP doesn't bundle it -->
        <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

        <!-- this fixture will load after Vue is loaded; `iklob` requires Vue to be exposed on the global scope -->
        <script src="./../dist/sample-fixtures/iklob-fixture.js"></script>

        <!-- loading main RAMP file; this needs to be loaded after Vue -->
        <script src="./../dist/RAMP.umd.js"></script>
    </head>
    <body>
        <noscript>
            <strong>We're sorry but ramp-core doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
        </noscript>
        <div id="app"></div>

        <script>
            function initRAMP() {
                console.log('RAMP has loaded.');
            }
        </script>

        <script>
            let rInstance;

            function initRAMP() {
                rInstance = new RAMP.Instance(document.getElementById('app'), {
                    map: {
                        extent: {
                            xmax: -5007771.626060756,
                            xmin: -16632697.354854,
                            ymax: 10015875.184845109,
                            ymin: 5022907.964742964,
                            spatialReference: {
                                wkid: 102100,
                                latestWkid: 3857
                            }
                        },
                        lods: RAMP.geoapi.maps.defaultLODs(RAMP.geoapi.maps.defaultTileSchemas()[1]), // idx 1 = mercator
                        basemaps: [
                            {
                                id: 'esriImagery',
                                tileSchemaId: 'DEFAULT_ESRI_World_AuxMerc_3857',
                                layers: [
                                    {
                                        layerType: 'esriTile',
                                        url: 'http://services.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer'
                                    }
                                ]
                            }
                        ],
                        initialBasemapId: 'esriImagery'
                    },
                    layers: [
                        {
                            id: 'WaterQuantity',
                            layerType: 'esriMapImage',
                            url: 'http://maps-cartes.ec.gc.ca/arcgis/rest/services/CESI/MapServer',
                            layerEntries: [
                                {
                                    index: 1,
                                    state: {
                                        opacity: 1,
                                        visibility: true
                                    }
                                }
                            ],
                            state: {
                                opacity: 1,
                                visibility: true
                            },
                            customRenderer: {} // just to chill things out. real ramp will have all properties defaulted and filled in
                        },
                        {
                            id: 'CleanAir',
                            layerType: 'esriFeature',
                            url: 'http://maps-cartes.ec.gc.ca/arcgis/rest/services/EcoGeo/EcoGeo/MapServer/9',
                            state: {
                                opacity: 0.8,
                                visibility: true
                            },
                            customRenderer: {} // just to chill things out. real ramp will have all properties defaulted and filled in
                        },
                        {
                            id: 'HydrometricStations',
                            layerType: 'ogcWfs',
                            url: 'http://geo.wxod-dev.cmc.ec.gc.ca/geomet/features/collections/hydrometric-stations/items?startindex=7500',
                            state: {
                                visibility: true
                            },
                            customRenderer: {} // just to chill things out. real ramp will have all properties defaulted and filled in
                        },
                        {
                            id: 'Happy',
                            layerType: 'esriFeature',
                            fileType: 'geojson',
                            url: 'http://fgpv.cloudapp.net/demo/__assets__/Sample%20Data/happy.json',
                            state: {
                                visibility: true
                            },
                            customRenderer: {} // just to chill things out. real ramp will have all properties defaulted and filled in
                        }
                    ],
                    fixtures: {
                        appbar: {
                            items: [
                                { id: 'gazebo', options: { colour: '#54a0ff' } },
                                'divider',
                                'snowman-appbar-button',
                                'legend',
                                'geosearch',
                                'basemap',
                                'divider'
                            ]
                        }
                    }
                });

                // start loading fixtures; this is just an example

                rInstance.fixture.add('appbar');
                rInstance.fixture.add('mapnav');
                rInstance.fixture.add('snowman');
                rInstance.fixture.add('gazebo');
                rInstance.fixture.add('geosearch');
                rInstance.fixture.add('basemap');
                rInstance.fixture.add('legend');
                rInstance.fixture.add('grid');

                rInstance.fixture.add('diligord', window.hostFixtures.diligord);
                rInstance.fixture.add('mouruge', window.hostFixtures.mouruge);
            }
        </script>
    </body>
</html>
